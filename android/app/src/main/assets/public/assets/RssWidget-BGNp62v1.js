import{c as j,r as a,j as e,g as B}from"./index-BPhsty-W.js";import{f as T,p as Q}from"./pt-BR-0dgV4ihQ.js";import{C as W,N as F}from"./newspaper-Bl_3g7yu.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=j("CloudLightning",[["path",{d:"M6 16.326A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 .5 8.973",key:"1cez44"}],["path",{d:"m13 12-3 5h4l-3 5",key:"1t22er"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=j("CloudRain",[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M16 14v6",key:"1j4efv"}],["path",{d:"M8 14v6",key:"17c4r9"}],["path",{d:"M12 16v6",key:"c8a4gj"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=j("CloudSnow",[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M8 15h.01",key:"a7atzg"}],["path",{d:"M8 19h.01",key:"puxtts"}],["path",{d:"M12 17h.01",key:"p32p05"}],["path",{d:"M12 21h.01",key:"h35vbk"}],["path",{d:"M16 15h.01",key:"rnfrdf"}],["path",{d:"M16 19h.01",key:"1vcnzz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=j("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=j("Wind",[["path",{d:"M12.8 19.6A2 2 0 1 0 14 16H2",key:"148xed"}],["path",{d:"M17.5 8a2.5 2.5 0 1 1 2 4H2",key:"1u4tom"}],["path",{d:"M9.8 4.4A2 2 0 1 1 11 8H2",key:"75valh"}]]);function he({showDate:t=!0,showSeconds:c=!1,backgroundImage:l,className:i=""}){const[s,r]=a.useState(new Date);a.useEffect(()=>{const y=setInterval(()=>{r(new Date)},1e3);return()=>clearInterval(y)},[]);const b=c?"HH:mm:ss":"HH:mm";return e.jsxs("div",{className:`relative flex flex-col items-center justify-center text-white h-full w-full overflow-hidden ${i}`,children:[l&&e.jsx(e.Fragment,{children:e.jsx("img",{src:l,alt:"Background",className:"absolute inset-0 w-full h-full object-cover -z-10",style:{objectPosition:"center"}})}),e.jsxs("div",{className:"z-10 text-center drop-shadow-md",children:[e.jsx("p",{className:"text-[7rem] leading-none font-black tracking-tighter",children:T(s,b)}),t&&e.jsx("p",{className:"text-4xl text-white/90 mt-4 font-bold",children:T(s,"EEEE, dd 'de' MMMM",{locale:Q})})]})]})}const U=a.createContext(null),te=()=>{const t=a.useContext(U);if(!t)throw new Error("useWidgetData must be used within a WidgetDataProvider");return t},ue=({children:t})=>{const[c,l]=a.useState({temperature:0,weatherCode:0,windSpeed:0,loaded:!1,error:null}),[i,s]=a.useState({items:[],loaded:!1,error:null}),[r,b]=a.useState(null),[y,d]=a.useState(null),v=async(n,p)=>{try{const w=await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${n}&longitude=${p}&current=temperature_2m,weather_code,wind_speed_10m&timezone=auto`);if(!w.ok)throw new Error("Failed to fetch weather");const o=await w.json();l({temperature:Math.round(o.current.temperature_2m),weatherCode:o.current.weather_code,windSpeed:Math.round(o.current.wind_speed_10m),loaded:!0,error:null})}catch(w){console.error("Weather Context Error:",w),l(o=>({...o,error:"Erro ao atualizar clima"}))}};a.useEffect(()=>{if(!r)return;v(r.lat,r.lon);const n=setInterval(()=>{v(r.lat,r.lon)},30*60*1e3);return()=>clearInterval(n)},[r]);const N=(n,p)=>{(!r||Math.abs(r.lat-n)>.1||Math.abs(r.lon-p)>.1)&&b({lat:n,lon:p})},C=n=>{n!==y&&d(n)};return e.jsx(U.Provider,{value:{weather:c,rss:i,refreshWeather:N,refreshRss:C},children:t})},re=t=>t===0?e.jsx(Z,{className:"h-12 w-12 text-yellow-400 drop-shadow-lg"}):t>=1&&t<=3?e.jsx(W,{className:"h-12 w-12 text-gray-300 drop-shadow-lg"}):t>=45&&t<=48?e.jsx(W,{className:"h-12 w-12 text-gray-400 drop-shadow-lg"}):t>=51&&t<=67?e.jsx(L,{className:"h-12 w-12 text-blue-400 drop-shadow-lg"}):t>=71&&t<=77?e.jsx(H,{className:"h-12 w-12 text-blue-200 drop-shadow-lg"}):t>=80&&t<=82?e.jsx(L,{className:"h-12 w-12 text-blue-500 drop-shadow-lg"}):t>=85&&t<=86?e.jsx(H,{className:"h-12 w-12 text-white drop-shadow-lg"}):t>=95&&t<=99?e.jsx(Y,{className:"h-12 w-12 text-yellow-300 drop-shadow-lg"}):e.jsx(W,{className:"h-12 w-12 text-gray-300 drop-shadow-lg"}),ae=t=>t===0?"Céu limpo":t>=1&&t<=3?"Parcialmente nublado":t>=45&&t<=48?"Neblina":t>=51&&t<=55?"Garoa":t>=56&&t<=57?"Garoa congelante":t>=61&&t<=65?"Chuva":t>=66&&t<=67?"Chuva congelante":t>=71&&t<=75?"Neve":t===77?"Granizo":t>=80&&t<=82?"Pancadas de chuva":t>=85&&t<=86?"Pancadas de neve":t>=95&&t<=99?"Tempestade":"Desconhecido";function me({latitude:t=-23.5505,longitude:c=-46.6333,backgroundImage:l,className:i=""}){const{weather:s,refreshWeather:r}=te();return a.useEffect(()=>{r(t,c)},[t,c,r]),!s.loaded&&!s.error?e.jsx("div",{className:`text-white flex items-center justify-center h-full w-full ${i}`,children:e.jsx(B,{className:"h-12 w-12 animate-spin text-white/50"})}):s.error&&!s.loaded?null:e.jsxs("div",{className:`relative flex flex-col items-center justify-center text-white p-6 h-full w-full overflow-hidden ${i}`,children:[l&&e.jsx(e.Fragment,{children:e.jsx("img",{src:l,alt:"Background",className:"absolute inset-0 w-full h-full object-cover -z-10 transition-opacity duration-700 opacity-100",style:{objectPosition:"center",willChange:"transform"}})}),e.jsxs("div",{className:"z-10 flex flex-col items-center gap-6 drop-shadow-2xl animate-in fade-in duration-700 slide-in-from-bottom-4",children:[e.jsx("div",{className:"scale-[2.5] mb-4 filter drop-shadow-lg",children:re(s.weatherCode)}),e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-[9rem] leading-none font-black tracking-tighter drop-shadow-xl",children:[s.temperature,"°"]}),e.jsx("p",{className:"text-5xl text-white/95 font-bold capitalize mt-2 drop-shadow-lg",children:ae(s.weatherCode)})]}),e.jsxs("div",{className:"flex items-center gap-3 text-white/90 bg-white/10 px-8 py-3 rounded-full mt-8 backdrop-blur-md border border-white/20 shadow-xl",children:[e.jsx(ee,{className:"h-6 w-6"}),e.jsxs("span",{className:"text-2xl font-semibold",children:[s.windSpeed," km/h"]})]})]})]})}function fe({feedUrl:t="https://g1.globo.com/rss/g1/",maxItems:c=10,scrollSpeed:l=8,className:i="",variant:s="full",backgroundImage:r,backgroundImageLandscape:b,backgroundImagePortrait:y}){const[d,v]=a.useState([]),[N,C]=a.useState(0),[n,p]=a.useState(!0),[w,o]=a.useState(null);if(a.useEffect(()=>{let m=!0;const h=new AbortController,z=setTimeout(()=>h.abort(),15e3);(async()=>{try{console.log("[RSS] Fetching via proxy:",t);const k=`https://corsproxy.io/?${encodeURIComponent(t)}`,S=await fetch(k,{signal:h.signal});if(!S.ok)throw new Error(`Network response was not ok: ${S.status}`);const O=await S.text(),R=new DOMParser().parseFromString(O,"text/xml");if(R.querySelector("parsererror"))throw new Error("XML Parsing failed");const V=R.querySelectorAll("item"),M=[];V.forEach((f,X)=>{var P,A,_,$;if(X>=c)return;const D=((P=f.querySelector("title"))==null?void 0:P.textContent)||"",J=((A=f.querySelector("link"))==null?void 0:A.textContent)||"",K=((_=f.querySelector("pubDate"))==null?void 0:_.textContent)||"",E=(($=f.querySelector("description"))==null?void 0:$.textContent)||"";let u="";const I=f.getElementsByTagNameNS("http://search.yahoo.com/mrss/","content");if(I.length>0&&(u=I[0].getAttribute("url")||""),!u){const x=f.querySelector("enclosure");x&&(u=x.getAttribute("url")||"")}if(!u&&E)try{const q=new DOMParser().parseFromString(E,"text/html").querySelector("img");q&&(u=q.getAttribute("src")||"")}catch{}if(!u){const x=f.getElementsByTagName("media:content");x.length>0&&(u=x[0].getAttribute("url")||"")}D&&M.push({title:D,link:J,pubDate:K,description:E,imageUrl:u})}),m&&(M.length>0?(v(M),o(null)):(console.warn("[RSS] No items found in feed"),o("Nenhum item encontrado no RSS.")))}catch(k){console.error("[RSS] Client-side fetch error:",k),m&&(k.name==="AbortError"?o("Tempo limite de conexão excedido."):o("Erro ao carregar notícias. Verifique a conexão."))}finally{clearTimeout(z),m&&p(!1)}})();const G=setInterval(()=>{},10*60*1e3);return()=>{m=!1,h.abort(),clearTimeout(z),clearInterval(G)}},[t,c]),a.useEffect(()=>{if(d.length===0)return;const m=setInterval(()=>{C(h=>(h+1)%d.length)},l*1e3);return()=>clearInterval(m)},[d.length,l]),n)return e.jsx("div",{className:`text-white flex items-center justify-center h-full w-full bg-black ${i}`,children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx(B,{className:"h-8 w-8 animate-spin text-primary"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Carregando notícias..."})]})});if(w||d.length===0)return e.jsxs("div",{className:`relative w-full h-full bg-black flex items-center justify-center ${i}`,children:[r?e.jsx("img",{src:r,className:"absolute inset-0 w-full h-full object-cover opacity-50"}):null,e.jsxs("div",{className:"relative z-10 flex flex-col items-center p-4 bg-black/60 rounded-xl backdrop-blur-md border border-white/10",children:[e.jsx(F,{className:"h-10 w-10 text-gray-500 mb-2"}),e.jsx("p",{className:"text-gray-300 font-medium",children:"Feed Indisponível"})]})]});const g=d[N];return e.jsxs("div",{className:`relative w-full h-full flex flex-col justify-end overflow-hidden bg-black ${i}`,children:[e.jsxs("div",{className:"absolute inset-0 z-0 select-none pointer-events-none",children:[g.imageUrl?e.jsx("img",{src:g.imageUrl,alt:g.title,className:"w-full h-full object-cover animate-in fade-in duration-700"},g.imageUrl):r?e.jsx("img",{src:r,alt:"Background",className:"w-full h-full object-cover opacity-60"}):e.jsx("div",{className:"w-full h-full bg-gradient-to-br from-indigo-900 to-slate-900 flex items-center justify-center",children:e.jsx(F,{className:"h-32 w-32 text-white/5"})}),e.jsx("div",{className:"absolute inset-x-0 bottom-0 h-4/5 bg-gradient-to-t from-black via-black/80 to-transparent opacity-90"})]}),e.jsxs("div",{className:"relative z-10 w-full max-w-7xl mx-auto px-8 pb-12 md:pb-16 flex flex-col justify-end h-full",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4 animate-in slide-in-from-bottom-5 duration-700 fade-in",children:[e.jsx("span",{className:"bg-[#c4170c] text-white text-[10px] md:text-xs font-bold px-3 py-1 rounded shadow-sm uppercase tracking-wider",children:"Ao Vivo"}),e.jsx("div",{className:"h-4 w-px bg-white/30"}),e.jsx("span",{className:"text-gray-300 text-xs md:text-sm font-medium uppercase tracking-widest truncate max-w-[200px]",children:new URL(t).hostname.replace(/^www\./,"")})]}),e.jsx("h1",{className:"text-3xl md:text-5xl lg:text-6xl font-black text-white leading-[1.1] drop-shadow-2xl line-clamp-3 mb-6 animate-in slide-in-from-bottom-5 duration-1000 fill-mode-both delay-100",children:g.title}),e.jsx("div",{className:"w-full max-w-md animate-in slide-in-from-bottom-5 duration-1000 fill-mode-both delay-200",children:e.jsx("div",{className:"flex gap-1.5 h-1.5 w-full",children:d.map((m,h)=>e.jsx("div",{className:`flex-1 rounded-full transition-all duration-300 ${h===N?"bg-white shadow-[0_0_8px_rgba(255,255,255,0.6)]":"bg-white/20"}`},h))})})]})]})}export{he as C,fe as R,ue as W,me as a};
