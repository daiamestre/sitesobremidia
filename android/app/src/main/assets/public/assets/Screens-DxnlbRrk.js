import{c as Z,u as me,r as t,j as e,M as B,B as R,g as ue,s as P,w as j,n as Re,z as Le,o as ee,H as Me,y as he,E as le,$ as qe,p as ne,C as xe,P as K,x as Fe,W as ie,a0 as Oe,a1 as ze,a2 as Be}from"./index-CgsZF8V8.js";import{C as O,d as z}from"./card-CHajswva.js";import{I as F}from"./input-BXt62FnX.js";import{B as H}from"./badge-DoKy377i.js";import{D as He,a as Ve,b as $e,c as q}from"./dropdown-menu-CPmszrny.js";import{A as Qe,a as Ue,b as We,c as Ke,d as Je,e as Ge,f as Xe,g as Ye}from"./alert-dialog-BGOHAcz_.js";import{D as pe,a as fe,b as ge,c as je,T as ve,S as W,E as Ze}from"./skeleton-BgfVuYMs.js";import{L as _}from"./label-BvKbhVou.js";import{T as es}from"./textarea-DzhEpiOg.js";import{S as ye}from"./switch-D910_8f8.js";import{S as J,a as G,b as X,c as Y,d as V}from"./select-BEfZu1TD.js";import{u as ss}from"./index-BN0HV7Dx.js";import{C as as}from"./check-PWvlflQ4.js";import{C as oe}from"./clock-CtQr6c5o.js";import{u as ts}from"./useQuery-D5Gpi0zK.js";import{u as ce}from"./index-DVhQhBJJ.js";import{S as rs}from"./search-CBkfYqrp.js";import{E as ls}from"./ellipsis-vertical-103cw0L8.js";import{P as ns}from"./pencil-D9uHNroI.js";import{C as is}from"./copy-IphMGVu4.js";import{P as os}from"./play-D4Qpkrev.js";import{f as cs,p as ds}from"./pt-BR-0dgV4ihQ.js";import"./index-DCd0Kai6.js";import"./index-DBNvBrPj.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ms=Z("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const us=Z("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hs=Z("MonitorSmartphone",[["path",{d:"M18 8V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h8",key:"10dyio"}],["path",{d:"M10 19v-3.96 3.15",key:"1irgej"}],["path",{d:"M7 19h5",key:"qswx4l"}],["rect",{width:"6",height:"10",x:"16",y:"12",rx:"2",key:"1egngj"}]]),xs=[{value:"16x9",label:"16x9 (Horizontal)",icon:"horizontal"},{value:"9x16",label:"9x16 (Vertical)",icon:"vertical"}];function ps({open:r,onOpenChange:c,screen:n,onSaved:k}){const{user:f}=me(),[l,h]=t.useState(""),[S,v]=t.useState(""),[o,i]=t.useState(""),[d,b]=t.useState("16x9"),[m,x]=t.useState(""),[C,y]=t.useState(null),[p,g]=t.useState(!0),[A,E]=t.useState([]),[T,D]=t.useState(!1);t.useEffect(()=>{r&&(async()=>{const{data:a}=await P.from("playlists").select("id, name").eq("is_active",!0).order("name");E(a||[])})()},[r]),t.useEffect(()=>{n?(h(n.name),v(n.description||""),i(n.location||""),b(n.resolution||"16x9"),x(n.custom_id||""),y(n.playlist_id),g(n.is_active)):(h(""),v(""),i(""),b("16x9"),x(""),y(null),g(!0))},[n,r]);const L=async()=>{if(!f)return;if(!l.trim()){j.error("Nome é obrigatório");return}if(!m.trim()){j.error("ID é obrigatório");return}if(!/^[a-zA-Z0-9_-]+$/.test(m)){j.error("ID deve conter apenas letras, números, hífens e underscores");return}const a=d==="16x9"?"landscape":"portrait";D(!0);try{if(n){const{error:w}=await P.from("screens").update({name:l,description:S||null,location:o||null,resolution:d,orientation:a,playlist_id:C,is_active:p,custom_id:m}).eq("id",n.id);if(w){if(w.code==="23505"){j.error("Este ID já está em uso. Escolha outro.");return}throw w}j.success("Tela atualizada!")}else{const{error:w}=await P.from("screens").insert({name:l,description:S||null,location:o||null,resolution:d,orientation:a,playlist_id:C,is_active:p,user_id:f.id,custom_id:m});if(w){if(w.code==="23505"){j.error("Este ID já está em uso. Escolha outro.");return}throw w}j.success("Tela criada!")}k(),c(!1)}catch(w){console.error("Error saving screen:",w),j.error("Erro ao salvar tela")}finally{D(!1)}};return e.jsx(pe,{open:r,onOpenChange:c,children:e.jsxs(fe,{className:"max-h-[85vh] flex flex-col p-0 gap-0",children:[e.jsx(ge,{className:"p-6 pb-2 shrink-0",children:e.jsx(je,{children:n?"Editar Tela":"Nova Tela"})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 pt-2 custom-scrollbar space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{htmlFor:"name",children:"Nome *"}),e.jsx(F,{id:"name",value:l,onChange:u=>h(u.target.value),placeholder:"Ex: Rezepção, Vitrine, Sala de Espera"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{htmlFor:"custom_id",children:"ID Personalizado"}),e.jsx(F,{id:"custom_id",value:m,onChange:u=>x(u.target.value),placeholder:"Ex: TELA-01, RECEPCAO-MAIN",className:"font-mono uppercase"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Identificador único usado na URL do player."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{htmlFor:"description",children:"Descrição/Localização"}),e.jsx(es,{id:"description",value:S,onChange:u=>v(u.target.value),placeholder:"Onde esta tela está localizada?"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{children:"Formato"}),e.jsxs(J,{value:d,onValueChange:b,children:[e.jsx(G,{children:e.jsx(X,{})}),e.jsx(Y,{children:xs.map(u=>e.jsx(V,{value:u.value,children:e.jsxs("div",{className:"flex items-center gap-2",children:[u.icon==="horizontal"?e.jsx(B,{className:"h-4 w-4"}):e.jsx(hs,{className:"h-4 w-4"}),u.label]})},u.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{children:"Playlist Padrão"}),e.jsxs(J,{value:C||"none",onValueChange:u=>y(u==="none"?null:u),children:[e.jsx(G,{children:e.jsx(X,{placeholder:"Selecione..."})}),e.jsxs(Y,{children:[e.jsx(V,{value:"none",children:"Nenhuma"}),A.map(u=>e.jsx(V,{value:u.id,children:u.name},u.id))]})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between border rounded-lg p-3",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(_,{children:"Tela Ativa"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Se desativada, o player mostrará tela preta"})]}),e.jsx(ye,{checked:p,onCheckedChange:g})]})]}),e.jsxs("div",{className:"p-4 border-t bg-background mt-auto flex justify-end gap-2 shrink-0",children:[e.jsx(R,{variant:"outline",onClick:()=>c(!1),children:"Cancelar"}),e.jsx(R,{onClick:L,disabled:T,children:T?e.jsx(ue,{className:"h-4 w-4 animate-spin"}):"Salvar"})]})]})})}var $="Checkbox",[fs]=Re($),[gs,se]=fs($);function js(r){const{__scopeCheckbox:c,checked:n,children:k,defaultChecked:f,disabled:l,form:h,name:S,onCheckedChange:v,required:o,value:i="on",internal_do_not_use_render:d}=r,[b,m]=Me({prop:n,defaultProp:f??!1,onChange:v,caller:$}),[x,C]=t.useState(null),[y,p]=t.useState(null),g=t.useRef(!1),A=x?!!h||!!x.closest("form"):!0,E={checked:b,disabled:l,setChecked:m,control:x,setControl:C,name:S,form:h,value:i,hasConsumerStoppedPropagationRef:g,required:o,defaultChecked:M(f)?!1:f,isFormControl:A,bubbleInput:y,setBubbleInput:p};return e.jsx(gs,{scope:c,...E,children:vs(d)?d(E):k})}var Ne="CheckboxTrigger",be=t.forwardRef(({__scopeCheckbox:r,onKeyDown:c,onClick:n,...k},f)=>{const{control:l,value:h,disabled:S,checked:v,required:o,setControl:i,setChecked:d,hasConsumerStoppedPropagationRef:b,isFormControl:m,bubbleInput:x}=se(Ne,r),C=he(f,i),y=t.useRef(v);return t.useEffect(()=>{const p=l==null?void 0:l.form;if(p){const g=()=>d(y.current);return p.addEventListener("reset",g),()=>p.removeEventListener("reset",g)}},[l,d]),e.jsx(ee.button,{type:"button",role:"checkbox","aria-checked":M(v)?"mixed":v,"aria-required":o,"data-state":_e(v),"data-disabled":S?"":void 0,disabled:S,value:h,...k,ref:C,onKeyDown:le(c,p=>{p.key==="Enter"&&p.preventDefault()}),onClick:le(n,p=>{d(g=>M(g)?!0:!g),x&&m&&(b.current=p.isPropagationStopped(),b.current||p.stopPropagation())})})});be.displayName=Ne;var ae=t.forwardRef((r,c)=>{const{__scopeCheckbox:n,name:k,checked:f,defaultChecked:l,required:h,disabled:S,value:v,onCheckedChange:o,form:i,...d}=r;return e.jsx(js,{__scopeCheckbox:n,checked:f,defaultChecked:l,disabled:S,required:h,onCheckedChange:o,name:k,form:i,value:v,internal_do_not_use_render:({isFormControl:b})=>e.jsxs(e.Fragment,{children:[e.jsx(be,{...d,ref:c,__scopeCheckbox:n}),b&&e.jsx(ke,{__scopeCheckbox:n})]})})});ae.displayName=$;var Ce="CheckboxIndicator",we=t.forwardRef((r,c)=>{const{__scopeCheckbox:n,forceMount:k,...f}=r,l=se(Ce,n);return e.jsx(Le,{present:k||M(l.checked)||l.checked===!0,children:e.jsx(ee.span,{"data-state":_e(l.checked),"data-disabled":l.disabled?"":void 0,...f,ref:c,style:{pointerEvents:"none",...r.style}})})});we.displayName=Ce;var Se="CheckboxBubbleInput",ke=t.forwardRef(({__scopeCheckbox:r,...c},n)=>{const{control:k,hasConsumerStoppedPropagationRef:f,checked:l,defaultChecked:h,required:S,disabled:v,name:o,value:i,form:d,bubbleInput:b,setBubbleInput:m}=se(Se,r),x=he(n,m),C=ss(l),y=qe(k);t.useEffect(()=>{const g=b;if(!g)return;const A=window.HTMLInputElement.prototype,T=Object.getOwnPropertyDescriptor(A,"checked").set,D=!f.current;if(C!==l&&T){const L=new Event("click",{bubbles:D});g.indeterminate=M(l),T.call(g,M(l)?!1:l),g.dispatchEvent(L)}},[b,C,l,f]);const p=t.useRef(M(l)?!1:l);return e.jsx(ee.input,{type:"checkbox","aria-hidden":!0,defaultChecked:h??p.current,required:S,disabled:v,name:o,value:i,form:d,...c,tabIndex:-1,ref:x,style:{...c.style,...y,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});ke.displayName=Se;function vs(r){return typeof r=="function"}function M(r){return r==="indeterminate"}function _e(r){return M(r)?"indeterminate":r?"checked":"unchecked"}const Ee=t.forwardRef(({className:r,...c},n)=>e.jsx(ae,{ref:n,className:ne("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),...c,children:e.jsx(we,{className:ne("flex items-center justify-center text-current"),children:e.jsx(as,{className:"h-4 w-4"})})}));Ee.displayName=ae.displayName;const de=[{value:0,label:"Dom",fullLabel:"Domingo"},{value:1,label:"Seg",fullLabel:"Segunda"},{value:2,label:"Ter",fullLabel:"Terça"},{value:3,label:"Qua",fullLabel:"Quarta"},{value:4,label:"Qui",fullLabel:"Quinta"},{value:5,label:"Sex",fullLabel:"Sexta"},{value:6,label:"Sáb",fullLabel:"Sábado"}];function ys({open:r,onOpenChange:c,screenId:n,screenName:k}){const[f,l]=t.useState([]),[h,S]=t.useState([]),[v,o]=t.useState(!0),[i,d]=t.useState(!1),[b,m]=t.useState(!1),[x,C]=t.useState(""),[y,p]=t.useState(""),[g,A]=t.useState("08:00"),[E,T]=t.useState("18:00"),[D,L]=t.useState([1,2,3,4,5]),[u,a]=t.useState(0),w=async()=>{try{const[s,N]=await Promise.all([P.from("screen_schedules").select("*, playlist:playlist_id(name)").eq("screen_id",n).order("priority",{ascending:!1}),P.from("playlists").select("id, name").eq("is_active",!0).order("name")]);if(s.error)throw s.error;if(N.error)throw N.error;l(s.data||[]),S(N.data||[])}catch(s){console.error("Error fetching schedules:",s),j.error("Erro ao carregar agendamentos")}finally{o(!1)}};t.useEffect(()=>{r&&(o(!0),w())},[r,n]);const te=()=>{C(""),p(""),A("08:00"),T("18:00"),L([1,2,3,4,5]),a(0),m(!1)},De=async()=>{if(!x.trim()||!y){j.error("Preencha nome e playlist");return}if(g>=E){j.error("O horário final deve ser posterior ao inicial");return}if(D.length===0){j.error("Selecione pelo menos um dia");return}d(!0);try{const{error:s}=await P.from("screen_schedules").insert({screen_id:n,playlist_id:y,name:x,start_time:g,end_time:E,days_of_week:D,priority:u});if(s)throw s;j.success("Agendamento criado!"),te(),w()}catch(s){console.error("Error creating schedule:",s),j.error("Erro ao criar agendamento")}finally{d(!1)}},Pe=async(s,N)=>{try{const{error:I}=await P.from("screen_schedules").update({is_active:N}).eq("id",s);if(I)throw I;l(Q=>Q.map(U=>U.id===s?{...U,is_active:N}:U))}catch(I){console.error("Error updating schedule:",I),j.error("Erro ao atualizar agendamento")}},Ae=async s=>{try{const{error:N}=await P.from("screen_schedules").delete().eq("id",s);if(N)throw N;l(I=>I.filter(Q=>Q.id!==s)),j.success("Agendamento excluído!")}catch(N){console.error("Error deleting schedule:",N),j.error("Erro ao excluir agendamento")}},Te=s=>{L(N=>N.includes(s)?N.filter(I=>I!==s):[...N,s].sort())},re=s=>s.substring(0,5),Ie=s=>s.length===7?"Todos os dias":JSON.stringify(s.sort())===JSON.stringify([1,2,3,4,5])?"Dias úteis":JSON.stringify(s.sort())===JSON.stringify([0,6])?"Fins de semana":s.map(N=>de[N].label).join(", ");return e.jsx(pe,{open:r,onOpenChange:c,children:e.jsxs(fe,{className:"sm:max-w-2xl max-h-[85vh] flex flex-col p-0 gap-0",children:[e.jsx(ge,{className:"p-6 pb-2 shrink-0",children:e.jsxs(je,{className:"flex items-center gap-2",children:[e.jsx(xe,{className:"h-5 w-5"}),"Agendamentos - ",k]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6 pt-2 custom-scrollbar",children:v?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(ue,{className:"h-8 w-8 animate-spin text-primary"})}):e.jsxs("div",{className:"space-y-4",children:[f.length===0&&!b?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(oe,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"Nenhum agendamento configurado"}),e.jsx("p",{className:"text-sm",children:"A playlist padrão será exibida o tempo todo"})]}):e.jsx("div",{className:"space-y-2",children:f.map(s=>{var N;return e.jsx(O,{className:s.is_active?"":"opacity-60",children:e.jsx(z,{className:"p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-medium",children:s.name}),s.priority>0&&e.jsxs(H,{variant:"secondary",className:"text-xs",children:["Prioridade ",s.priority]})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:((N=s.playlist)==null?void 0:N.name)||"Playlist não encontrada"}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-sm",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(oe,{className:"h-3 w-3"}),re(s.start_time)," - ",re(s.end_time)]}),e.jsx("span",{className:"text-muted-foreground",children:Ie(s.days_of_week)})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ye,{checked:s.is_active,onCheckedChange:I=>Pe(s.id,I)}),e.jsx(R,{variant:"ghost",size:"icon",onClick:()=>Ae(s.id),className:"text-destructive hover:text-destructive",children:e.jsx(ve,{className:"h-4 w-4"})})]})]})})},s.id)})}),b?e.jsx(O,{children:e.jsxs(z,{className:"p-4 space-y-4",children:[e.jsx("h4",{className:"font-medium",children:"Novo Agendamento"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{children:"Nome"}),e.jsx(F,{value:x,onChange:s=>C(s.target.value),placeholder:"Ex: Horário comercial"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{children:"Playlist"}),e.jsxs(J,{value:y,onValueChange:p,children:[e.jsx(G,{children:e.jsx(X,{placeholder:"Selecione..."})}),e.jsx(Y,{children:h.map(s=>e.jsx(V,{value:s.id,children:s.name},s.id))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{children:"Início"}),e.jsx(F,{type:"time",value:g,onChange:s=>A(s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{children:"Fim"}),e.jsx(F,{type:"time",value:E,onChange:s=>T(s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{children:"Prioridade"}),e.jsx(F,{type:"number",min:0,max:100,value:u,onChange:s=>a(parseInt(s.target.value)||0)})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{children:"Dias da semana"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:de.map(s=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ee,{id:`day-${s.value}`,checked:D.includes(s.value),onCheckedChange:()=>Te(s.value)}),e.jsx(_,{htmlFor:`day-${s.value}`,className:"text-sm cursor-pointer",children:s.fullLabel})]},s.value))})]}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx(R,{variant:"outline",onClick:te,disabled:i,children:"Cancelar"}),e.jsx(R,{onClick:De,disabled:i,className:"gradient-primary",children:i?"Salvando...":"Adicionar"})]})]})}):e.jsxs(R,{variant:"outline",className:"w-full",onClick:()=>m(!0),children:[e.jsx(K,{className:"h-4 w-4 mr-2"}),"Adicionar Agendamento"]}),e.jsxs("div",{className:"bg-muted/50 rounded-lg p-3 text-sm text-muted-foreground",children:[e.jsx("p",{children:e.jsx("strong",{children:"Como funciona:"})}),e.jsxs("ul",{className:"list-disc list-inside mt-1 space-y-1",children:[e.jsx("li",{children:"Se não houver agendamento ativo, a playlist padrão da tela é exibida"}),e.jsx("li",{children:"Agendamentos com maior prioridade têm preferência se houver sobreposição"}),e.jsx("li",{children:"A transição entre playlists ocorre automaticamente no horário definido"})]})]})]})}),e.jsx("div",{className:"p-4 border-t bg-background mt-auto flex justify-end gap-2 shrink-0",children:e.jsx(R,{variant:"outline",onClick:()=>c(!1),children:"Fechar"})})]})})}function Ns(r){const c=Fe(),n=async()=>{const{data:o,error:i}=await P.from("screens").select(`
                *,
                playlist:playlists(id, name)
            `).eq("user_id",r).order("created_at",{ascending:!1});if(i)throw i;const d=new Date;return(o||[]).map(m=>{let x="offline";if(m.last_ping_at){const C=new Date(m.last_ping_at),y=(d.getTime()-C.getTime())/1e3;y<60?x="playing":y<300&&(x="online")}return{...m,status:x,playlist:m.playlist||null,orientation:m.orientation}})},{data:k=[],isLoading:f,refetch:l}=ts({queryKey:["screens",r],queryFn:n,enabled:!!r||void 0,refetchInterval:3e4}),h=ce({mutationFn:async o=>{const{error:i}=await P.from("screens").delete().eq("id",o);if(i)throw i;return o},onSuccess:()=>{c.invalidateQueries({queryKey:["screens"]}),j.success("Tela excluída!")},onError:o=>{console.error("Error deleting screen:",o),j.error("Erro ao excluir tela")}}),S=ce({mutationFn:async({screenId:o,command:i})=>{const{error:d}=await P.from("remote_commands").insert({screen_id:o,command:i,status:"pending"});if(d)throw d;return{screenId:o,command:i}},onSuccess:(o,i)=>{j.success(`Comando enviado: ${i.command}`)},onError:()=>{j.error("Erro ao enviar comando")}}),v=async(o,i)=>{try{return await S.mutateAsync({screenId:o,command:i}),!0}catch{return!1}};return{screens:k,loading:f,fetchScreens:l,deleteScreen:h.mutateAsync,sendCommand:v}}function Us(){const{user:r}=me(),{screens:c,loading:n,fetchScreens:k,deleteScreen:f,sendCommand:l}=Ns(r==null?void 0:r.id),[h,S]=t.useState(""),[v,o]=t.useState(!1),[i,d]=t.useState(null),[b,m]=t.useState(null),[x,C]=t.useState(null),[y,p]=t.useState(!1),g=a=>{const w=`${window.location.origin}/player/${a}`;navigator.clipboard.writeText(w),j.success("URL copiada para a área de transferência")},A=async()=>{x&&(p(!0),await f(x),p(!1),C(null))},E=a=>{m(a),o(!0)},T=a=>{d(a)},D=c.filter(a=>{var w;return a.name.toLowerCase().includes(h.toLowerCase())||((w=a.location)==null?void 0:w.toLowerCase().includes(h.toLowerCase()))}),L=c.filter(a=>a.is_active).length,u=c.filter(a=>a.status==="online"||a.status==="playing").length;return e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-display font-bold",children:"Telas"}),e.jsx("p",{className:"text-muted-foreground",children:"Gerencie seus dispositivos e players"})]}),e.jsxs(R,{className:"gradient-primary",onClick:()=>{m(null),o(!0)},children:[e.jsx(K,{className:"h-4 w-4 mr-2"}),"Nova Tela"]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsx(O,{className:"glass",children:e.jsxs(z,{className:"flex items-center gap-4 p-4",children:[e.jsx("div",{className:"p-3 rounded-lg bg-primary/10",children:e.jsx(B,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:c.length}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total de Telas"})]})]})}),e.jsx(O,{className:"glass",children:e.jsxs(z,{className:"flex items-center gap-4 p-4",children:[e.jsx("div",{className:"p-3 rounded-lg bg-success/10",children:e.jsx(ie,{className:"h-6 w-6 text-success"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:u}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Online"})]})]})}),e.jsx(O,{className:"glass",children:e.jsxs(z,{className:"flex items-center gap-4 p-4",children:[e.jsx("div",{className:"p-3 rounded-lg bg-accent/10",children:e.jsx(B,{className:"h-6 w-6 text-accent"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:L}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Ativas"})]})]})})]}),e.jsxs("div",{className:"relative max-w-md",children:[e.jsx(rs,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(F,{placeholder:"Buscar telas...",value:h,onChange:a=>S(a.target.value),className:"pl-10"})]}),n?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[...Array(6)].map((a,w)=>e.jsxs("div",{className:"flex flex-col space-y-3",children:[e.jsx(W,{className:"h-[200px] w-full rounded-xl"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(W,{className:"h-4 w-3/4"}),e.jsx(W,{className:"h-4 w-1/2"})]})]},w))}):D.length===0?e.jsx(Ze,{icon:B,title:h?"Nenhuma tela encontrada":"Nenhuma tela cadastrada",description:h?"Tente ajustar sua busca com outros termos.":"Adicione telas para começar a exibir suas playlists.",action:h?void 0:{label:"Criar Tela",onClick:()=>{m(null),o(!0)},icon:K}}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:D.map(a=>e.jsx(O,{className:"glass group hover:shadow-lg transition-shadow overflow-hidden border-l-4",style:{borderLeftColor:a.status==="playing"?"#22c55e":a.status==="online"?"#3b82f6":"#ef4444"},children:e.jsxs(z,{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-semibold truncate",children:a.name}),a.status==="playing"&&e.jsx(H,{className:"bg-green-500 hover:bg-green-600",children:"Reproduzindo"}),a.status==="online"&&e.jsx(H,{className:"bg-blue-500 hover:bg-blue-600",children:"Online"}),a.status==="offline"&&e.jsx(H,{variant:"secondary",children:"Offline"})]}),a.location&&e.jsxs("div",{className:"flex items-center gap-1 text-sm text-muted-foreground mt-1",children:[e.jsx(us,{className:"h-3 w-3"}),e.jsx("span",{className:"truncate",children:a.location})]})]}),e.jsxs(He,{children:[e.jsx(Ve,{asChild:!0,children:e.jsx(R,{variant:"ghost",size:"icon",className:"h-8 w-8",children:e.jsx(ls,{className:"h-4 w-4"})})}),e.jsxs($e,{align:"end",children:[e.jsxs(q,{onClick:()=>E(a),children:[e.jsx(ns,{className:"h-4 w-4 mr-2"}),"Editar"]}),e.jsxs(q,{onClick:()=>T(a),children:[e.jsx(xe,{className:"h-4 w-4 mr-2"}),"Agendar"]}),e.jsxs(q,{onClick:()=>g(a.id),children:[e.jsx(is,{className:"h-4 w-4 mr-2"}),"Copiar URL"]}),e.jsxs(q,{onClick:()=>window.open(`/player/${a.id}`,"_blank"),children:[e.jsx(Oe,{className:"h-4 w-4 mr-2"}),"Abrir Player"]}),e.jsxs(q,{onClick:()=>l(a.id,"reload"),children:[e.jsx(ze,{className:"h-4 w-4 mr-2"}),"Recarregar Player"]}),e.jsxs(q,{onClick:()=>l(a.id,"screenshot"),children:[e.jsx(ms,{className:"h-4 w-4 mr-2"}),"Capturar Tela"]}),e.jsxs(q,{onClick:()=>C(a.id),className:"text-destructive",children:[e.jsx(ve,{className:"h-4 w-4 mr-2"}),"Excluir"]})]})]})]}),e.jsx("div",{className:"flex items-center gap-4 text-sm text-muted-foreground mt-4 p-3 bg-muted/30 rounded-lg",children:e.jsx("div",{className:"flex flex-col gap-1 w-full",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs font-medium uppercase tracking-wider",children:"Playlist Atual"}),a.playlist?e.jsxs("div",{className:"flex items-center gap-1 text-primary",children:[e.jsx(os,{className:"h-3 w-3"}),e.jsx("span",{className:"font-medium truncate max-w-[120px]",children:a.playlist.name})]}):e.jsx("span",{className:"text-xs text-muted-foreground italic",children:"Nenhuma definida"})]})})}),e.jsxs("div",{className:"flex items-center justify-between mt-3 text-xs text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[a.status!=="offline"?e.jsx(ie,{className:"h-3 w-3 text-green-500"}):e.jsx(Be,{className:"h-3 w-3"}),e.jsx("span",{children:a.last_ping_at?`Visto ${cs(new Date(a.last_ping_at),"HH:mm",{locale:ds})}`:"Nunca visto"})]}),e.jsxs("span",{children:["v",a.version||"1.0"]})]})]})},a.id))}),e.jsx(ps,{open:v,onOpenChange:o,screen:b,onSaved:k}),i&&e.jsx(ys,{open:!!i,onOpenChange:a=>!a&&d(null),screenId:i.id,screenName:i.name}),e.jsx(Qe,{open:!!x,onOpenChange:a=>!a&&C(null),children:e.jsxs(Ue,{children:[e.jsxs(We,{children:[e.jsx(Ke,{children:"Excluir tela?"}),e.jsx(Je,{children:"Esta ação não pode ser desfeita."})]}),e.jsxs(Ge,{children:[e.jsx(Xe,{disabled:y,children:"Cancelar"}),e.jsx(Ye,{onClick:A,disabled:y,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:y?"Excluindo...":"Excluir"})]})]})})]})}export{Us as default};
